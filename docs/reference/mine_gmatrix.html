<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Mine G-matrices — mine_gmatrix • resevol</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Mine G-matrices — mine_gmatrix" />
<meta property="og:description" content="Mine networks for establishing the link between genome and g-matrix. The 
output from this function is required to run individual-based simulations
in the rest of the package. The key input to this function, 'gmatrix', is a
(square) covariance matrix, with each row and column representing a trait for
the individual-based model. This function will run an evolutionary algorithm
to try to find a network that produces traits with the covariance structure
of gmatrix from a set of random standard normal values. The network from loci
values to trait values goes through a number of linked nodes to achieve this, 
and each generation tests the stress of the resulting network in terms of 
expected squared deviation of trait covariances from the input gmatrix. 
Simulations can take minutes to hours or longer, depending on parameters 
chosen and the number of traits. See vignettes for a more comprehensive
explanation for what this function is doing." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">resevol</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.2.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/resevol.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/evolutionary_algorithm.html">The evolutionary algorithm</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://bradduthie.github.io/helicoverpa/notebook/helicoverpa_notes.html">Lab notebook</a>
</li>
<li>
  <a href="https://github.com/bradduthie/resevol">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Mine G-matrices</h1>
    <small class="dont-index">Source: <a href='https://github.com/bradduthie/resevol/blob/master/R/mine_gmatrix.R'><code>R/mine_gmatrix.R</code></a></small>
    <div class="hidden name"><code>mine_gmatrix.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Mine networks for establishing the link between genome and g-matrix. The 
output from this function is required to run individual-based simulations
in the rest of the package. The key input to this function, 'gmatrix', is a
(square) covariance matrix, with each row and column representing a trait for
the individual-based model. This function will run an evolutionary algorithm
to try to find a network that produces traits with the covariance structure
of gmatrix from a set of random standard normal values. The network from loci
values to trait values goes through a number of linked nodes to achieve this, 
and each generation tests the stress of the resulting network in terms of 
expected squared deviation of trait covariances from the input gmatrix. 
Simulations can take minutes to hours or longer, depending on parameters 
chosen and the number of traits. See vignettes for a more comprehensive
explanation for what this function is doing.</p>
    </div>

    <pre class="usage"><span class='fu'>mine_gmatrix</span><span class='op'>(</span>
  loci <span class='op'>=</span> <span class='fl'>18</span>,
  layers <span class='op'>=</span> <span class='fl'>6</span>,
  indivs <span class='op'>=</span> <span class='fl'>1000</span>,
  npsize <span class='op'>=</span> <span class='fl'>2000</span>,
  mu_pr <span class='op'>=</span> <span class='fl'>0.05</span>,
  mu_sd <span class='op'>=</span> <span class='fl'>0.01</span>,
  max_gen <span class='op'>=</span> <span class='fl'>1000</span>,
  pr_cross <span class='op'>=</span> <span class='fl'>0.05</span>,
  sampleK <span class='op'>=</span> <span class='fl'>40</span>,
  chooseK <span class='op'>=</span> <span class='fl'>4</span>,
  term_cri <span class='op'>=</span> <span class='op'>-</span><span class='fl'>5.3</span>,
  sd_ini <span class='op'>=</span> <span class='fl'>0.1</span>,
  use_cor <span class='op'>=</span> <span class='cn'>FALSE</span>,
  prnt_out <span class='op'>=</span> <span class='cn'>TRUE</span>,
  <span class='va'>gmatrix</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>loci</th>
      <td><p>The number of loci that individuals in the model will have</p></td>
    </tr>
    <tr>
      <th>layers</th>
      <td><p>The number of layers in the network from loci to traits</p></td>
    </tr>
    <tr>
      <th>indivs</th>
      <td><p>The number of individuals to test the covariance matrix</p></td>
    </tr>
    <tr>
      <th>npsize</th>
      <td><p>The size of the network population in the evolutionary algorithm</p></td>
    </tr>
    <tr>
      <th>mu_pr</th>
      <td><p>The probability of a network value to mutate</p></td>
    </tr>
    <tr>
      <th>mu_sd</th>
      <td><p>The standard deviation of mutation effect size</p></td>
    </tr>
    <tr>
      <th>max_gen</th>
      <td><p>The maximum number of generations of the evolutionary algorithm</p></td>
    </tr>
    <tr>
      <th>pr_cross</th>
      <td><p>The probability of a crossover occurring for a network</p></td>
    </tr>
    <tr>
      <th>sampleK</th>
      <td><p>Number of networks sampled to take part in tournament selection</p></td>
    </tr>
    <tr>
      <th>chooseK</th>
      <td><p>Number of winners in tournament selection</p></td>
    </tr>
    <tr>
      <th>term_cri</th>
      <td><p>Stress criteria (ln) for evolutionary algorithm terminating</p></td>
    </tr>
    <tr>
      <th>sd_ini</th>
      <td><p>StDev of initialised networked values</p></td>
    </tr>
    <tr>
      <th>use_cor</th>
      <td><p>Compare correlation matrix rather than the covariance matrix</p></td>
    </tr>
    <tr>
      <th>prnt_out</th>
      <td><p>Print out progress showing stress for each generation</p></td>
    </tr>
    <tr>
      <th>gmatrix</th>
      <td><p>G-matrix that the evolutionary algorithm will match</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A list of eight elements that includes the following: (1) A vector of
input parameters, (2) the pre-specified covariance matrix, (3) matrix defining
the effects of loci values on the first layer of the network, (4) a three
dimensional array link the first network layer to trait values, (5) a matrix
of the marginal effect of each locus on each trait, (6) the mined covariance
structure, (7) all network values to be inserted into individual genomes, and
(8) the log stress of the mined matrix against the pre-specified matrix.</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='va'>gmt</span>       <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span>data <span class='op'>=</span> <span class='fl'>0</span>, nrow <span class='op'>=</span> <span class='fl'>3</span>, ncol <span class='op'>=</span> <span class='fl'>3</span><span class='op'>)</span>;
<span class='fu'><a href='https://rdrr.io/r/base/diag.html'>diag</a></span><span class='op'>(</span><span class='va'>gmt</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='fl'>1</span>;
<span class='va'>mg</span>        <span class='op'>&lt;-</span> <span class='fu'>mine_gmatrix</span><span class='op'>(</span>gmatrix <span class='op'>=</span> <span class='va'>gmt</span>, loci <span class='op'>=</span> <span class='fl'>6</span>, layers <span class='op'>=</span> <span class='fl'>3</span>, indivs <span class='op'>=</span> <span class='fl'>100</span>, 
                         npsize <span class='op'>=</span> <span class='fl'>100</span>, max_gen <span class='op'>=</span> <span class='fl'>8</span>, prnt_out <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>;
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by A. Bradley Duthie, Rose McKeon.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


