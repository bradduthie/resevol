Comments addressed on 19 NOV 2022
=================================================

MT: Throughout this, I am left trying to imagine how the general case that you are describing applies to real world examples of crop protection products -- eg GM crops that are part of the plant being consumed, fungal biopesticides that have a mode of action that doesn't involve consumption standard sprayed insecticides, or biocontrol agents like wasps etc. Is there any scope to introduce a table (or similar) where you list different systems, and then in a separate column list the parameter values you could specify to make the model simulate that type of system? Perhaps that is too big a challenge?

BD: Yes, I think I see what you mean here @MattTinsleyStirling -- this might be difficult with a 3000-4000 word count for an Application article (i.e., software note), which we are already brushing up against. But I can see how it could work perhaps as a supporting information document and software vignette, like the Advanced Techniques (https://bradduthie.github.io/resevol/articles/advanced_techniques.html) and Evolutionary Algorithm (https://bradduthie.github.io/resevol/articles/evolutionary_algorithm.html) vignettes? I'm happy to try something like this because I think it would illustrate the current capabilities of the resevol package but also highlight areas for future development. For example, you could model fungal biopesticides, but you would need to assume that those biopesticides cannot coevolve with the pest; future versions of resevol could relax this assumption. I think that the 'pesticide' applied to a landscape could just as easily be interpreted as 'GM crop' (versus non-GM crop). At least, I can't think of how we would model the two differently, so maybe this is similar to an earlier comment by @luc-bussiere about making sure that the generality of the software is clear (Luc pointed out that 'crop type' could equally well just be interpeted as 'landscape type', more generally). **ACTION POINT**: It would be *massively* helpful if folks could provide some instructive examples of different types of systems and their key differences (i.e., the first column that @MattTinsleyStirling describes). What I can do then is fill in the second column -- i.e., prod me with questions "how would I model X", and I will respond "Set up parameters like Y". I'll make a new issue.

MT: I'll admit I always find the term 'genetic covariance' unintuitive in its meaning when it is 'thrown into' text. I wonder whether this paragraph might be helped by including 1 sentence introducing the general concept of fitness tradeoffs caused by pesticide resistance alleles (which should be intuitive to readers), then point out that these tradeoffs are an example of genetic covariance..... and that thisis therefore important.... Something like: "Multiple traits determine the overall fitness of any pest genotype; for example, whilst pesticide resistance alleles enhance fitness in the presence of a pesticide, they can impose reproductive fitness costs. Such trade-offs can be quantified by the genetic covariance between traits. A focal goal of oour software is to model traits....."

BD: Yes, I like this. Again, there is a careful line to walk between explaining the software in too specific terms (e.g., X is crop biomass grown in a cell in one time step) versus too abstractly (e.g., X is some real number on each cell). The former makes it sound like the software is restricted in what it can do, while the latter gives very little guidance to the reader about what they might want to *actually* do with it. In this case, the 'traits' are really any potentially evolving characteristic of an individual pest, so I have tried to be quite general, but I think that your suggested sentence adds some useful context while not being too restrictive. What does everyone else think? Also, is there an especially good reference for, "while pesticide resistance alleles enhance fitness in the presence of a pesticide, they can impose reproductive fitness costs"?

MT: I was a little confused by this wording (and below, including with reference to multiple pesticides). I am confused by my assumption that any one pest does not move much and is therefore only able to experience one crop and one pesticide that are present in the landscape cell it lives in. Is 'pests consume' here referring to pests as individuals or pests are a population spread over the landscape?

BD: Yes, I see what you mean. This gets tricky because only one food type exists per cell (at least, for now, this is all that is allowed), but the `food_consume` argument specifies how much of each crop type is consumed. Hence, if `food_consume = c(0.5, 1.5)`, e.g., then a pest on a cell with crop type 1 will consume 0.5 units, and if they are on crop type 2, they will consume 1.5 units. Also note that this only applies when the amount of food consumed is *not* an evolving trait; if it is an evolving trait, then `food_consume = c("T1", "T2")`, and the amount of each crop consumed is determined by the individual pest's trait value. My hope is that this becomes clearer in the 'Pest Evolution' section? But do you think more detail is needed here?

MT: In reference to my previous point -- this statement makes total sense, but I didn't think that the lines above were leading up to it..... sorry for being confused....

BD: Would it make sense to move this sentence earlier? I'm not quite sure I follow, but is part of the difficulty that the evolving traits have not yet been introduced? This was something I battled with quite a bit in explaining the methods; the ecology and evolution are deeply intertwined, but I think that they need to be explained separately to avoid confusion -- but then one of the them needs to come first, and I don't think that the evolutionary side makes any sense if it precedes the ecology of what the pests are doing.


MT: Seeing as the model is all about pesticide resistance evolution (or tolerance), it seems odd to me that there is no mention of survival ability following pesticide exposure/consumption up until here -- have I missed something? Somehow I was expecting there to be a section on how you decide whether individuals live/die reproduce/not reproduce following pesticide encounters?

BD: Yes, I see what you mean. I don't think an entire section is possible given the word constraints, but maybe a well-placed sentence or phrase would signpost that pesticide consumption can affect survival and reproduction. I have gone quite light on the explanation because the technical details of how survival and reproduction are enacted are really quite simple, but it's good to mention. I've moved the last sentence of the second paragraph from Section 3.2 up a bit, then finished that paragraph with the sentence, "Pesticide consumption affects pest survival and reproduction using `pesticide_tolerated_surv` and `pesticide_tolerated_repr` arguments.". What do you think?

MT: this might not be helpful, but I find the concept find the concept of two traits determining consumption rates of the two pesticides a little unintuitive without some explanation. I guess this could represent the evolution of avoidance behaviour whereby a pest specifically evolves to avoid consuming one pesticide or the other (or both) -- this sounds cool and super relevant. Otherwise, I naively imagine that feeding rate is fixed for any pesticide by virtue of the feeding rate of the pest on that particular crop. Would it be more intuitive to focus here on two traits that are defined as resistance/tolerance to two different pesticides?

BD: Yeah, I see what you mean. What I was trying to do here is to construct a minimal example of the package use; one that illustrates how to use the package without necessarily being biologically realistic. I'm interpreting 'consume' in a more general sense, I guess, in terms of how much of the pesticide applied to the landscape cell actually gets into the pest's system, so to speak. What if I changed "define the rate at which pests consume two separate pesticides" to "define the realised rate of uptake of the two separate pesticides"? Does that make a bit more sense? I actually kind of like that because it kind of emphasises to the reader that 'consume' doesn't need to be taken literally, necessarily.

MT: I think this line partially addresses my previous comments about not seeing an explanation of what the effects of the pesticide were on the pests and how this altered the population. However, it seems to me from this description that if any feeding on pesticide causes death, then in a field cell where all plants are covered in pesticide, then the 'pesticide consume' argument essentially determines if the pests are susceptible or resistant to the pesticide? It is just that this seems a little unintuitive in my mind because if all plants in a pesticide patch are sprayed then it isn't possible to consume food without consuming pesticide? Perhaps?

BD: Yes, I see what you mean. I've tweaked this sentence to 'Pests can uptake (i.e., 'consume') pesticides in ages 0-2, and if they consume any pesticide, then they will die'. You're correct that, basically, if a pest imbibes any pesticide, they die. This is meant to be as simple of an example as possible to illustrate the function (i.e., I'm more concerned with demonstrating the software than making the example biologically realistic), but perhaps we might plausibly envision a system in which some pests do not feed on part of the plant on which the pesticide is sprayed, so plant consumption still happens despite no uptake of pesticide? While another type of pesticide might be concentrated in a part of a plant that is consumed by the pest? While pesticide consumption *might* be directly proportional to crop consumption, the software doesn't require it.

MT: This wording ignores the fact that the crop plants may grow and get bigger during the season -- this added 'realism' probably isn't needed in the model, but is it worth tweaking this wording in order to reflect that the amount of crop may not be static? I guess the principle that you are describing -- that at high pest densities the pests may defoliate the crop and reduce food abundance is totally fine.

BD: This is an interesting point, and potentially a good feature to add for future versions of resevol. Currently crops appear on the landscape in a fixed density, the timing of which is determined by `crop_rotation_time`. But after they appear, that density cannot increase. It's worth maybe building a new function in at some point, like `crop_growth`, which could increase the landscape value of crop by some proportion in each time step to simulate the increase in biomass of individiual plant growth. Is it worth highlighting the assumption here? Alternatively, I could actually try to add `crop_growth` into the package now as something like a fixed parameter for each crop type that determines the proportion of increase each time step (e.g., after the crop is initialised, it increases by a proportion of 0.5 each time step). I like the idea, since the defult could just be `crop_growth = 0`, but is it worth putting into the package prior to submission?

MT: Is it worth mentioning how time-step equates to season? I think people could be confused about whether this represents 50 years, 50 seasons of 50 time segments of a single season?

BD: Time steps could represent a single season, or they could just represent a single month or week, or even a day. I'm really reluctant to imply a specific timeframe because I fear it could make the software seem unnecessarily restrictive. By default, I tend to think of seasons as being the same number of time steps as `crop_rotation_time` (e.g., if `crop_rotation_time = 16`, then a season is 16 time steps), but this doesn't need to be the case.

MT: I think this is the first time in the manuscript that you identify the fact that the impact of resistance alleles may be specific to different pesticides ..... and here I think you identify that cross resistance can evolve. Is it worth inserting a few lines nearer the start to identify this as a key issue (perhaps in the bit I highlighted above explaining the details of covariances)? 

BD: Yes, maybe just a tweak. What I really want to do is overload the reader with every single feature of the package too quickly. But maybe a tweak to the sentence, "For example, while pesticide resistance alleles enhance fitness in the presence of a pesticide, they can impose reproductive fitness costs", would be good? I have revised to "For example, while alleles conferring resistance to a particular pesticide enhance fitness in the presence of that pesticide, they could also impose reproductive fitness costs". This might 

MT: Sorry! I am confused by this bit. Figure 3b shows mean pesticide consumed for each pesticide -- if I understand it, this is basically resistance evolution and the pests have evolved not to consume both pesticides, so that they have become resistant and the pesticides are not effective. If this is right, then I don't quite understand what the difference between b and d is? If Trait 1 is how much pesticide 1 is consumed, why isn't this the same as the black line in plot b?

BD: I think I see the confusion here, and my hope is that the earlier comments on consumption versus trait clear it up a bit, but I'm also tweaking the legend to make it clearer. The new relevant sentence of the legend now reads, "Panels show (a) pesticide abundance change, (b) mean realised amount of pesticides 1 and 2 uptaken per pest, (c) mean food consumed per pest, and (d) mean value of evolving traits 1 and 2 underlying pest uptake over time. Note that only pests with positive values for traits 1 or 2 can uptake pesticides 1 or 2, respectively. Pests with negative trait values will be unaffected by corresponding pesticides (i.e., pesticide consumption is a threshold trait), hence the difference between realised pesticide consumption (b) and the traits underlying it (d)."

